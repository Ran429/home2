// This schema is updated for the Human Vulnerability Research Institute website.
// It uses a generic 'Post' model to manage all content types (Type1, Type2, Type4).
//C:\Users\zeroj\klea-main\home\home2\prisma\schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  // Make sure to set these environment variables in your .env file
  url       = env("POSTGRES_PRISMA_URL")
  directUrl = env("POSTGRES_URL_NON_POOLING")
}

// A generic model for all content: pages, posts, gallery items, etc.
model Post {
  id          Int      @id @default(autoincrement())
  // Main category from the menu (e.g., 'introduction', 'activities', 'achievements')
  category    String
  // Sub-category or specific page identifier (e.g., 'history', 'projects', 'publications')
  slug        String   @unique
  // Content type to determine the layout (Type1: Page, Type2: List, Type4: Gallery)
  contentType String   @map("content_type")

  title       String
  content     String
  // For featured images (e.g., in list or gallery thumbnails)
  featuredImage Json?    @map("featured_image")
  // For gallery images or other media
  images      Json?
  // For file attachments
  files       Json?
  
  viewCount   Int      @default(0) @map("view_count")
  isActive    Boolean  @default(true) @map("is_active")
  isImportant Boolean  @default(false) @map("is_important") // For highlighting posts
  createdBy   String   @map("created_by")
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@index([category, isActive])
  @@index([contentType, isActive])
  @@map("td_post")
}


// Model for partner logos/links (replaces AssociateCompany)
model Partner {
  id          Int      @id @default(autoincrement())
  name        String   // Partner's name
  logoImage   Json     @map("logo_image")
  link        String?  // Optional link to partner's website
  description String?
  sortOrder   Int      @default(0) @map("sort_order")
  isActive    Boolean  @default(true) @map("is_active")
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@index([isActive, sortOrder])
  @@map("td_partner")
}


// Admin account model remains the same
model AdminAccount {
  id        Int      @id @default(autoincrement())
  userId    String   @unique @map("user_id")
  password  String
  name      String
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("td_admin_account")
}


// Model for research institute members (people in organization)
model Member {
  id        Int      @id @default(autoincrement())
  name      String
  role      String
  photoUrl  String?   @map("photo_url") // 이미지 경로 or 업로드 URL
  bio       String?   // 간단한 소개
  isActive  Boolean  @default(true) @map("is_active")
  sortOrder Int      @default(0)    @map("sort_order")
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@index([isActive, sortOrder])
  @@map("td_member")
}
