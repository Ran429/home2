// prisma/schema.prisma
// Final schema for Institute for Human Vulnerability

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")   // Supabase pooler
}

// ✅ 게시판 (공지사항, 연구성과, 사회공헌활동 등 리스트형)
model Board {
  id        Int      @id @default(autoincrement())
  boardType String
  title     String
  content   String
  images    Json?
  files     Json?

  viewCount Int      @default(0)
  isActive  Boolean  @default(true)
  createdBy String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([boardType, isActive])
  @@map("td_board")
}

// ✅ 갤러리 (워크숍, 출판물, 미디어 보도 등 이미지 중심)
model Gallery {
  id          Int      @id @default(autoincrement())
  galleryType String
  title       String
  description String?
  thumbnail   String?
  images      Json?
  isActive    Boolean  @default(true)
  viewCount   Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([galleryType, isActive])
  @@map("td_gallery")
}

// ✅ 파트너 (협력사/파트너 로고 관리)
model Partner {
  id          Int      @id @default(autoincrement())
  name        String
  logoImage   Json     @map("logo_image")
  link        String?
  description String?
  sortOrder   Int      @default(0) @map("sort_order")
  isActive    Boolean  @default(true) @map("is_active")
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@index([isActive, sortOrder])
  @@map("td_partner")
}

// ✅ 관리자 계정
model AdminAccount {
  id        Int      @id @default(autoincrement())
  userId    String   @unique @map("user_id")
  password  String
  name      String
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("td_admin_account")
}

// ✅ 단일 페이지 (소개, 연혁, 비전, 윤리헌장 등)
model SinglePage {
  id        Int      @id @default(autoincrement())
  slug      String   @unique
  title     String
  content   String
  metaDescription String?
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("SinglePage") // Supabase 테이블명 그대로 매핑
}